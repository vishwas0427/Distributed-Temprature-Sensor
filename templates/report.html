{%load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>DTS-VER-2</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href={% static '/assets/img/favicon.png' %} rel="icon">
    <link href={% static '/assets/img/apple-touch-icon.png' %} rel="apple-touch-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href={% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %} rel="stylesheet">
    <link href={% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %} rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href={% static 'assets/css/style.css' %} rel="stylesheet">

    <!-- ===== DataTables Js and CSS File ===== -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" charset="utf8"
        src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

</head>

<body style="overflow: hidden;">
    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center">

        <div class="d-flex align-items-center justify-content-between">
            <a class="logo d-flex align-items-center">
                <img src={% static 'assets/img/logo.png' %} alt="" style="height: 3vh;">
                <span class="d-none d-lg-block">DTS-VER-2</span>
            </a>
            <i class="bi bi-list toggle-sidebar-btn"></i>
        </div><!-- End Logo -->

    </header><!-- End Header -->

    <!-- ===== Sidebar ===== -->
    <aside id="sidebar" class="sidebar">
        <ul class="sidebar-nav" id="sidebar-nav">
            <li class="nav-item" style="width: 40vh;">
                <a class="nav-link " href="dashboard_page">
                    <i class="bi bi-houses-fill" style="color: #0000B8"></i>
                    <span style="color: #0000B8;font-size:2.5vh;">Dashboard</span>
                </a>
                <a class="nav-link " href="configuration_page">
                    <i class="bi bi-gear-fill" style="color: #0000B8"></i>
                    <span style="color: #0000B8;font-size:2.5vh;">Configurations</span>
                </a>
                <a class="nav-link " href="report_page">
                    <i class="bi bi-file-earmark-text" style="color: #0000B8"></i>
                    <span style="color: #0000B8;font-size:2.5vh;">Reports</span>
                </a>
            </li>
        </ul>
    </aside>

    <main id="main" class="main">
        <section class="section dashboard">
            <div class="card col-12" style="height: 85vh;">
                <h5 class="card-title" style="color: #0000B8;font-size:2.8vh;">Reports</h5>
                <div style="width: 100%;">
                    <div >
                        <label
                            style="font-weight: bold; margin-left: 2vh; margin-bottom: 2vh; float: left; ;font-size:2.5vh;"
                            for="zone_name">Channel number</label>
                    </div>
                    <div >
                        <select id="zh_channel_selection"
                            style="font-size:2.5vh;padding: 1.5vh; margin-bottom: 2vh; ;border: 1px solid #ccc; border-radius: 3px; width:20vh; float: left;margin-left: 4vh;">

                        </select>
                    </div>
                    <div >
                        <label
                            style="font-weight: bold; margin-left: 13vh; margin-bottom: 2vh; float: left; ;font-size:2.5vh;"
                            for="zone_name">Start Distance</label>
                    </div>
                    <div style="width: 11%; float: left;">
                        <input type="date"
                            style="padding: 1.5vh; height: 7vh;margin-bottom: 2vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;margin-left:4vh;"
                            id="zone_name" name="zone_name">
                    </div>
                    <div>
                        <label
                            style="font-weight: bold; margin-left: 15vh; margin-bottom: 2vh; float: left; ;font-size:2.5vh;"
                            for="start_dist">End Distance</label>
                    </div>
                    <div>
                        <input type="date"
                            style="padding: 1.5vh;height: 7vh;font-size:2.5vh;margin-left: 4vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;"
                            id="start_dist" >
                    </div>
                </div>
                <div style="width: 100%;">
                    <div >
                        <label
                            style="font-weight: bold; margin-left: 2vh; margin-bottom: 2vh; float: left; ;font-size:2.5vh;width: 20vh;margin-top: 5vh;"
                            for="zone_name">Temp Orange Alarm Max</label>
                    </div>
                    <div >
                        <input type="text"
                        style="padding: 1.5vh;margin-top: 5vh; height: 7vh;margin-bottom: 2vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;margin-left:5vh;"
                        id="zone_name" name="zone_name">
                    </div>
                    <div >
                        <label
                            style="font-weight: bold; margin-bottom: 2vh; margin-left: 13vh;float: left; ;font-size:2.5vh;width: 20vh;margin-top: 5vh;"
                            for="zone_name">Temp Orange Alarm Min</label>
                    </div>
                    <div style="width: 11%; float: left;">
                        <input type="text"
                            style="padding: 1.5vh;margin-top: 5vh; height: 7vh;margin-bottom: 2vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;margin-left:2vh;"
                            id="zone_name" name="zone_name">
                    </div>
                    <div>
                        <label
                            style="font-weight: bold; margin-left: 12vh; margin-bottom: 2vh; float: left; ;font-size:2.5vh;width: 20vh;margin-top: 5vh;"
                            for="start_dist">Temp Red Alarm Max</label>
                    </div>
                    <div>
                        <input type="number"
                            style="padding: 1.5vh;height: 7vh;margin-top: 5vh;font-size:2.5vh;margin-left: 0.5vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;"
                            id="start_dist" >
                    </div>
                </div>
                <div style="width: 100%;">
                    <div >
                        <label
                            style="font-weight: bold; margin-left: 5vh; margin-bottom: 2vh; float: left; ;font-size:2.5vh;width: 20vh;margin-top: 5vh;"
                            for="zone_name">Temp Red Alarm Min</label>
                    </div>
                    <div >
                        <input type="text"
                            style="padding: 1.5vh;margin-top: 5vh; height: 7vh;margin-bottom: 2vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;margin-left:2vh;"
                            id="zone_name" name="zone_name">
                    </div>
                    <div >
                        <label
                            style="font-weight: bold; margin-bottom: 2vh; margin-left: 13vh;float: left; ;font-size:2.5vh;width: 20vh;margin-top: 5vh;"
                            for="zone_name">Fiber Break</label>
                    </div>
                    <div style="width: 11%; float: left;">
                        <input type="text"
                            style="padding: 1.5vh;margin-top: 5vh; height: 7vh;margin-bottom: 2vh; border: 1px solid #ccc; border-radius: 3px; width: 20vh; float: left;margin-left:2vh;"
                            id="zone_name" name="zone_name">
                    </div>
                </div>
                <div style="width: 100%;">
                    <div style="width: 100%;">
                        <button id="insert_zone_data" class="btn btn-primary"
                            style="height: 7vh; width:15%;margin-right: 4vh; float: right; margin-bottom: 2vh;font-size:2.5vh;margin-top: 25vh;">Filter</button>
                    </div>
                    <div style="width: 100%;">
                        <button id="delete" class="btn btn-primary"
                            style="font-size:2.5vh;height: 7vh; margin-right: 2vh; width:15%; margin-left: 90vh;
                            margin-bottom: 2vh;margin-top: 25vh; background-color: gray; ">Clear</button>
                    </div>
                </div>

            </div>
        </section>
    </main>
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src={% static 'assets/vendor/apexcharts/apexcharts.min.js' %}></script>
    <script src={% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}></script>
    <script src={% static 'assets/vendor/chart.js/chart.umd.js' %}></script>
    <script src={% static 'assets/vendor/echarts/echarts.min.js' %}></script>
    <script src={% static 'assets/vendor/quill/quill.min.js' %}></script>
    <script src={% static 'assets/vendor/simple-datatables/simple-datatables.js' %}></script>
    <script src={% static 'assets/vendor/tinymce/tinymce.min.js' %}></script>

    <!-- Template Main JS File -->
    <script src={% static 'assets/js/main.js' %}></script>

</body>
<!--  -->
<script>
    function updateOptions() {
        // Get the selected value from the first select tag
        var selectedValue = document.getElementById("channel_selection").value;

        // Get references to the second and third select tags
        var select2 = document.getElementById("ch_channel_selection");
        var select3 = document.getElementById("zh_channel_selection");

        // Clear existing options in the second and third select tags
        select2.innerHTML = "";
        select3.innerHTML = "";

        // Generate new options based on the selected value
        for (var i = 1; i <= selectedValue; i++) {
            var option = document.createElement("option");
            option.value = i;
            option.text = " " + i;

            // Append the option to both select2 and select3
            select2.add(option.cloneNode(true));
            select3.add(option.cloneNode(true));
        }
        localStorage.setItem("selectedValue", selectedValue);

    }
    function setInitialValues() {
        // Get the stored selected value from localStorage
        var storedValue = localStorage.getItem("selectedValue");

        // If a value is stored, set it as the selected value for both select2 and select3
        if (storedValue) {
            document.getElementById("channel_selection").value = storedValue;
            updateOptions();
        }
    }

    // Call setInitialValues when the page loads
    window.onload = setInitialValues;

</script>
<!-- ======================================================================================= -->





<!-- ===============================================showing data in fiber_length when any channel is selected================================= -->
<script>
    function default_data() {
        // Get the selected value from the first select tag
        var selectedValue = document.getElementById("ch_channel_selection").value;
        var fiberdata = document.getElementById("fiber_length").value;
        // localStorage.setItem("fiberdata", fiberdata);
        $.ajax({
            url: '/default_Data/', // Replace with your Django view's URL
            method: "GET",
            dataType: 'json',
            success: function (response) {
                fetch_datatable_fiber_data = response.get_channel_fiber
                if (selectedValue >= 1 && selectedValue <= fetch_datatable_fiber_data.length) {
                    var selectedData = fetch_datatable_fiber_data[selectedValue - 1];
                    console.log(selectedData);
                }
                document.getElementById("fiber_length").value = selectedData
                var selectedData2 = document.getElementById("fiber_length").value;



                console.log(fetch_datatable_fiber_data)
            },
            error: function (error) {
                console.error("Error receiving data:", error);
            }
        });
    }

</script>
<script>
    $(document).ready(function () {
        // Call the function to fetch start distance on page load
        updateStartDistance();

        // Attach the click event to #zh_channel_selection
        $('#zh_channel_selection').click(function () {
            // Call the function to fetch start distance when the dropdown is clicked
            updateStartDistance();
        });
    });

    function updateStartDistance() {
        var selectedChannel = $('#zh_channel_selection').val();

        // Use AJAX to fetch data from the server
        $.ajax({
            type: 'GET',
            url: '/get_end_dist/',
            data: { 'channel_num': selectedChannel },
            success: function (response) {
                console.log(response);
                $('#start_dist').val(response.end_dist);
            },
            error: function (error) {
                console.error("Error fetching data:", error);
            }
        });
    }


</script>


<!-- =======================================UPDATE DATA OF CHANNEL CONFIG==================================== -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var navigateButton = document.getElementById('submit_chn_config');
        navigateButton.addEventListener("click", function () {
            var channel_num = String(document.getElementById('ch_channel_selection').value);
            var fiber_len = String(document.getElementById('fiber_length').value);
            var csrfToken = '{{ csrf_token }}';

            $.ajax({
                method: "POST",
                url: '/update_channel_Config/',
                data: {
                    'channel_num': channel_num,
                    'fiber_len': fiber_len,

                },
                headers: { "X-CSRFToken": csrfToken },

                success: function (response) {
                    console.log("data sent successfully");
                },
                error: function (error) {
                    console.error("error sending data", error);
                }
            });
        });
    });

</script>
<!-- ================================================DELETING ZONE DATA AS PER SELECTED CHANNEL================================================ -->
<script>
    function delete_data() {
        // Get the selected value from the first select tag
        var selectedValue = document.getElementById("zh_channel_selection").value;
        var csrfToken = '{{ csrf_token }}';
        $.ajax({
            url: '/delete_Data/', // Replace with your Django view's URL
            method: "POST",
            data: {
                'selectedValue': selectedValue,
                csrfmiddlewaretoken: csrfToken,
            },
            success: function (response) {
                console.log(response);
                // Clear existing data in the DataTable
                zone_details_table.clear().draw();

                // Fetch and add new data to the DataTable
                $.ajax({
                    url: '/get_zone_config_data/', // Replace with your Django view's URL
                    method: "GET",
                    dataType: 'json',
                    success: function (response) {
                        fetch_datatable_zone_data = response.zone_config_data
                        zone_details_table.rows.add(fetch_datatable_zone_data).draw(false);
                    },
                    error: function (error) {
                        console.error("Error receiving data:", error);
                    }
                });
            },
            error: function (error) {
                console.error("Error receiving data:", error);
            }
        });
    }
</script>


</html>